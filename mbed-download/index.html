<!DOCTYPE html>
<html>
  <head>
    <!-- Origin Trial Token, feature = WebUSB, origin = https://devanlai.github.io, expires = 2016-12-30 -->
    <meta http-equiv="origin-trial" data-feature="WebUSB" data-expires="2016-12-30" content="AiBF9xf8KsDZ0+0pURr0xUo1nb4GI1+EmaOmaaU79ESiXCH9piNfU0M+FF4Xz99kkABOyOel0PMVMGP9AwHEVggAAABXeyJvcmlnaW4iOiAiaHR0cHM6Ly9kZXZhbmxhaS5naXRodWIuaW86NDQzIiwgImZlYXR1cmUiOiAiV2ViVVNCIiwgImV4cGlyeSI6IDE0ODMxMTA2Mzl9">
    <title>WebUSB mbed DFU</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
    <script src="mbed-compile-api.js"></script>
    <script src="../dfu-util/dfu.js"></script>
    <script src="../dfu-util/FileSaver.js"></script>
    <script src="mbed-download.js"></script>
    <style>
      p.warning {
        color: red;
      }
      p.error {
        color: red;
        font-weight: bold;
      }
      div.buildLog {
        max-height: 100ex;
        overflow: scroll;
        font-family: monospace;
      }
    </style>
  </head>
  <body>
    <fieldset>
      <legend>mbed</legend>
      <form>
        <p>
          <label for="username">mbed Username: </label>
          <input type="text" name="username" id="username"></input>
        </p>
        <p>
          <label for="password">Password: </label>
          <input type="password" name="password" id="password"></input>
          <button type="button" id="authenticate">Set Credentials</button>
        </p>
      </form>
      <fieldset>
        <legend>Remote Compiler API</legend>
        <p>
          <label for="repoURL">Repository URL: </label>
          <input type="url" name="repoURL" id="repoURL" value="https://developer.mbed.org/users/devanlai/code/STM32F103C8T6_WebUSBDFU/" size="72"/>
        </p>
        <p>
          <label for="targetPlatform">Target Platform: </label>
          <select name="targetPlatform" id="targetPlatform">
            <option value="ST-Nucleo-F103RB" selected>NUCLEO-F103RB</option>
          </select>
        </p>
        <p>
          <button type="button" name="build" id="build" disabled>Build</button>
        </p>
      </fieldset>
      <fieldset>
        <legend>Build Output</legend>
        <div id="mbedLog" class="buildLog"></div>
      </fieldset>
    </fieldset>
    <p>
      <span id="status"></span>
    </p>
    <p>
      <label for="vid">Vendor ID (hex):</label>
      <input type="text" name="vid" id="vid" value="0x1209" maxlength="6" size="6"/>
    </p>
    <p>
      <button id="connect">Connect</button>
    </p>
    <p>
      <div id="usbInfo" style="white-space: pre"></div>
      <div id="dfuInfo" style="white-space: pre"></div>
    </p>
    <fieldset>
      <legend>Runtime mode</legend>
      <button id="detach" disabled="true">Detach DFU</button>
    </fieldset>
    <fieldset>
      <label for="transferSize">Transfer Size:</label>
      <input type="number" name="transferSize" id="transferSize" value="1024"/>
      <legend>DFU mode</legend>
      <fieldset>
        <legend>Firmware Download (write to USB device)</legend>
        <p>
          <button id="download" disabled="true">Download</button>
          <span id="binaryInfo"></span>
        </p>
        <div class="log" id="downloadLog"></div>
      </fieldset>
    </fieldset>
  </body>
</html>
